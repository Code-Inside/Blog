---
layout: post
title: "vmware Server 2, Internet Access in VM & Services über Portforwarding freischalten"
date: 2011-04-04 20:17
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [Internet Access, VMWare]
---
{% include JB/setup %}
<p><a href="{{BASE_PATH}}/assets/wp-images/image1228.png"><img style="border-bottom: 0px; border-left: 0px; margin: 0px 10px 0px 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" align="left" src="{{BASE_PATH}}/assets/wp-images/image_thumb408.png" width="136" height="65" /></a>Ich habe einen VMWare Server 2 auf einem Windows 2008 R2 installiert um ein paar VMs darauf laufen zu lassen. Allerdings gab es ein kleines Problem: Wie bekommt die VM Interet Access in der VM und wie komme ich von außen an die Services der VM? Stichwort: NAT, Portforwarding und Internet Sharing sind die Zauberwörter.</p>  <p><strong>Kleine Warnung</strong></p>  <p>Ich bin kein IT/Netzwerk/Verkabelungsmeister - evtl. sind manche Settings doppelt oder gar unnötig. Ich schreib nur mal nieder, was bei mir zum Erfolg geführt hat :)</p>  <p><strong>Einstellungen in der VM tätigen</strong></p>  <p>Natürlich muss vorher VMWare Server installiert sein. Die erstellte VM (in meinem Fall ist es auch ein Windows) muss auf <strong>NAT</strong> eingestellt sein.</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1229.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb409.png" width="383" height="252" /></a> </p>  <p><strong>Das Problem: No Interet Connection</strong></p>  <p>VMWare installiert ein weiteres Netzwerk, allerdings hat dies keine Verbindung zum Internet.</p>  <p>(Das Bild stammt aus der "<a href="http://nandikajayawardana.blogspot.com/2010/12/how-to-fix-vmware-server-20-vm-no.html">Quelle</a>” meiner Lösung - da ich meine Konfiguration nicht mehr umstellen möchte, nehm ich das Bild. Wichtig ist: No Internet Access :( )</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1230.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb410.png" width="515" height="319" /></a> </p>  <p></p>  <p></p>  <p></p>  <p><strong>VMWare Adapter anpassen</strong></p>  <p>Nun muss man folgendes machen: </p>  <p>Den VMWare Virtual Network Manager als Administrator starten (ansonsten kann man keine Änderungen speichern) - Ort: C:\Program Files (x86)\VMware\VMware Server\vmnetcfg.exe</p>  <p>Dort muss der der Adapter Nr. 8 (der ist für NAT zuständig) bearbeiten.</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1231.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb411.png" width="343" height="271" /></a> </p>  <p>Dort muss unter Subnet die IP Adresse auf 192.168.137.0 eingestellt werden. (Vorher evtl. auch sicherstellen, dass der VMnet01 Adapter nicht diese IP Adresse bereits belegt!)</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1232.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb412.png" width="324" height="117" /></a> </p>  <p>Unter den NAT Settings die Gateway IP Adresse auf 192.168.137.1 stellen.</p>  <p></p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1233.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb413.png" width="311" height="124" /></a> </p>  <p><strong>Internet Sharing anschalten und was es mit 192.168.137.1 auf sich hat</strong></p>  <p>Nun ändert man die Netzwerkeinstellung von dem Netzwerk mit der Internet Verbindung. Unter den "Properties” unter "Sharing” kann man die Internetfreigabe aktivieren und wählt die VMnet08 Verbindung auf. Windows vergibt nun automatisch die 192.169.137.1 als Gateway für diese Internetfreigabe - daher brauchen wir dies als Gateway.</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1234.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb414.png" width="321" height="213" /></a> </p>  <p><strong>Damit sollte jetzt das Netzwerk auch Internet haben</strong></p>  <p>Seltsamerweise (dass kann vielleicht auch eine "Übeflüssige” Einstellung sein, habe ich dem VMNet08 Adapter noch folgende Einstellungen verpasst:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1235.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb415.png" width="251" height="277" /></a>&#160;</p>  <p><strong>VM Netzwerkeinstellungen</strong></p>  <p>Der VM habe ich eine IP Adresse 192.168.137.155 vergeben und zusätzlich hier auch noch den Default Gateway/DNS 192.168.137.1 eingetragen.</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1236.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb416.png" width="292" height="322" /></a> </p>  <p><strong>VMWare Virtual Network Manager - Portforwarding einschalten</strong></p>  <p></p>  <p></p>  <p></p>  <p>Wieder im VMWare Virtual Network Manager unter den Adapter Settings auf die NAT Einstellungen unserer VMNet08 Verbindung.</p>  <p>Unter dem Punkt Portforwarding kann man nun das Mapping einstellen.</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1237.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb417.png" width="400" height="280" /></a> </p>  <p>Falls das wieder Erwarten nicht klappt, gibt es noch ähnliche Einstellungen unter den Netzwerkeinstellungen:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image1238.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb418.png" width="244" height="187" /></a>&#160; </p>  <p>Dort kann man ähnliches machen - jedenfalls bei mir geht es auch ohne diese Einstellungen ;)</p>  <p><strong>Firewall Freischaltungen nicht vergessen</strong></p>  <p>Als letzten Schritt muss man natürlich noch die Firewall sowohl auf dem Host als auch in der VM entsprechend anpassen und den Port freischalten.</p>  <p><strong>Ergebnis</strong></p>  <p>Innerhalb der VM haben wir Internet Access und wir können über Portforwarding auch auf verschiedenste Dienste (nach Freischaltung in der Firewall) von aussen zugreifen.</p>  <p>Hauptquelle meiner Lösung: <a href="http://nandikajayawardana.blogspot.com/2010/12/how-to-fix-vmware-server-20-vm-no.html">How to fix VMWare server 2.0 VM No Internet Access issue on Windows 7</a></p>
