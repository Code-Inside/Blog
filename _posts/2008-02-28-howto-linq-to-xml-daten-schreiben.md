---
layout: post
title: "HowTo: LINQ to XML - Daten schreiben"
date: 2008-02-28 23:50
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [.NET 3.5, HowTo, LINQ, LINQ to XML, Xml]
---
{% include JB/setup %}
<p>Zuletzt haben wir bereits &#252;ber <a href="http://code-inside.de/blog/2008/02/26/howto-linq-to-xml-daten-lesen/">LINQ to XML Daten gelesen</a>, nun wollen wir Daten einfach mal schreiben.</p>  <p>Wie bereits in dem anderen HowTo geschrieben, versteckt sich die gesamte Funktionalit&#228;t eigentlich im <a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.aspx">System.Xml.Linq Namespace</a>. In der &quot;pr&#228;-.NET 3.5&quot; Zeit hat man &#252;ber einen <a href="http://msdn2.microsoft.com/en-us/library/system.xml.xmlwriter.aspx">XmlWriter</a> oder &#252;ber <a href="http://msdn2.microsoft.com/de-de/library/system.xml.xmldocument(VS.80).aspx">XmlDocument</a> m&#252;hselig die ganze Struktur aufbauen m&#252;ssen und (jedenfalls bei XmlDocument) &#252;ber Append anh&#228;ngen.</p>  <p>Herzst&#252;ck der gesamten Demoanwendung ist eigentlich das <a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.xelement.aspx">XElement</a> (f&#252;r die eigentlichen Xml Elemente) &amp; <a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.xattribute.aspx">XAttribut</a> (f&#252;r Xml Attribute).</p>  <p>Schauen wir uns erstmal das Ergebnis an:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image299.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="193" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb278.png" width="382" border="0" /></a> </p>  <p>Und hier der Code daf&#252;r (<em>ich bin immer noch ohne Live Writer Plugin unterwegs, download siehe unten</em>):</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image300.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="252" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb279.png" width="535" border="0" /></a> </p>  <p>Dieses Konstrukt sieht vielleicht auf dem ersten Blick seltsam aus, allerdings ist es durch die Formatierung klar und deutlich gegliedert. Max. die Kommas &amp; Klammern muss man beachten.</p>  <p>Der Grund f&#252;r diese schicke L&#246;sung, liegt in den Konstruktor der XElement Klasse - welche <a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.xcontainer.nodes.aspx">beliebig viele Nodes</a> aufnehmen kann. Das kann man nat&#252;rlich beliebig fortsetzen. </p>  <p>Das war es schon - jetzt kann man dieses XElement in ein <a href="http://msdn2.microsoft.com/de-de/library/system.xml.linq.xdocument.aspx">XDocument</a> einbetten und speichern - oder den String speichern etc.</p>  <p>Weitere Infos befinden sich z.B. <a href="http://www.hookedonlinq.com/LINQtoXML5MinuteOverview.ashx">hier</a> (oder in <a href="http://code-inside.de/blog/2008/02/26/howto-linq-to-xml-daten-lesen/">meinem anderen Blogeintrag</a>).</p>  <p><strong><a href="http://{{BASE_PATH}}/assets/files/democode/linqtoxmlwriter/linqtoxmlwriter.zip">[ Download Source Code ]</a></strong></p>
