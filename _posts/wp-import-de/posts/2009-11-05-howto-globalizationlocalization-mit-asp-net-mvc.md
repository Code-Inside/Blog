---
layout: post
title: "HowTo: Globalization/Localization mit ASP.NET MVC"
date: 2009-11-05 00:35
author: Robert Muehsig
comments: true
categories: [HowTo]
tags: [ASP.NET MVC, Deutsch, Englisch, Globalization, HowTo, Localization, MVC]
language: de
---
{% include JB/setup %}
<p><a href="{{BASE_PATH}}/assets/wp-images-de/image867.png"><img style="border-right: 0px; border-top: 0px; margin: 0px 10px 0px 0px; border-left: 0px; border-bottom: 0px" height="144" alt="image" src="{{BASE_PATH}}/assets/wp-images-de/image_thumb52.png" width="92" align="left" border="0"></a><strong><a href="{{BASE_PATH}}/2011/08/02/best-practice-localization-lokalisierung-einer-asp-net-mvc-webapp/">Es gibt ein Update zu diesem Blogpost!</a></strong>Mehrsprachigkeit ist in vielen Anwendungen wichtig bzw. kann es sich als sehr wichtig herausstellen. Im ASP.NET WebForms Modell gibt es Mittel und Wege dies mit den Controls und Ressourcendatein zu machen. Doch auch in ASP.NET MVC gibt es kleine Helferlein, die jedenfalls die einfache deutsch/englisch/... Mehrsprachigkeit abdecken. Bei andere Länder, wo z.B. von Rechts nach Links gelesen wird, muss man sich wahrscheinlich doch noch ein Konzept überlegen - das ist aber erst mal nicht der Fokus ;)</p><p>Die Grundimplemenation habe ich von <a href="http://blog.eworldui.net/post/2008/10/ASPNET-MVC-Simplified-Localization-via-ViewEngines.aspx">diesem Blog genommen</a> und erweitert. Irgendwo habe ich auch ein anderes Beispiel gefunden, wo ich auch Code genommen hatte, aber ich finde es jetzt leider nicht mehr. Unten findet ihr ein Download mit einer funktionstüchtigen Anwendung :)</p> <p><strong>Wie ist die Lösung aufgebaut</strong></p> <ul> <li>Ressourcendatein:</li> <ul> <li>Diese können unter "App_GlobalResources" oder "App_LocalResources" stehen</li></ul> <li>Html Helper um auf diese Ressourcen zuzugreifen.</li> <li>Ein LanguageController, damit der User die Sprache manuell auch noch umschalten kann.</li> <li>Einen LanguageHelper der die Sprache entweder vom Browser erkennt oder die aus der Session ausliesst (wird im LanguageController gesetzt).</li> <li>Einen LocalizedFilter, damit die entsprechende Sprache auch für den Request genutzt wird.</li> <li>Es wird eine eigene ViewEngine verwendet welche von der normalen ViewEngine abgeleitet ist. Dies dient der Speicherung des ViewPaths im ViewData. Dies könnte man noch sicherlich anpassen und vielleicht in einen Filter auslagern, aber es funktioniert erstmal ;)</li></ul> <p><strong>Demo Solution:</strong></p> <p><a href="{{BASE_PATH}}/assets/wp-images-de/image868.png"><img style="border-right: 0px; border-top: 0px; margin: 0px 10px 0px 0px; border-left: 0px; border-bottom: 0px" height="465" alt="image" src="{{BASE_PATH}}/assets/wp-images-de/image_thumb53.png" width="240" align="left" border="0"></a> Wichtig sind die Sachen im Code Ordner. Dort versteckt sich z.B. der Filter, der Helper und die eigene ViewEngine. </p> <p>Im Standardfall wird die eingestellte Sprache vom Browser genommen. Will der User eine andere Sprache auswählen will, geht er auf den LanguageController. Dort wird dann die Sprache in die Session geschrieben. Ein Cookie wäre auch möglich - habe ich aber nicht implementiert.</p> <p><strong>Ganz wichtig:</strong> Die ViewEngine muss auch wirklich in der Global.asax registriert werden!</p> <p>Auch wichtig: Alle Controller, bis auf den LanguageController, müssen mit dem LocalizedFilter dekoriert werden.</p> <p>&nbsp;</p> <p><strong>Anwendung in den Views</strong></p> <p>Zugriff via:</p> <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:e69e0f1c-6443-4ebf-b108-ff7148b25b04" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="c#">		Global resource : &lt;%=Html.Resource("Strings, GlobalResourceKey") %&gt;&lt;br /&gt;
		Local resource : &lt;%=Html.Resource("LocalKey")%&gt;&lt;br /&gt;</pre></div>
<p><strong>In den Controllern die Sprache ermitteln:</strong> </p>
<div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:bd558717-4e76-4da2-b97d-f730e75f1745" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="c#">LanguageHelper.GetLanguage(); </pre></div>
<p><strong>Und was sieht man am Ende:</strong></p>
<p>Deutsche Ansicht:</p>
<p><a href="{{BASE_PATH}}/assets/wp-images-de/image869.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="159" alt="image" src="{{BASE_PATH}}/assets/wp-images-de/image_thumb54.png" width="354" border="0"></a> </p>
<p>Englische Ansicht:</p>
<p><a href="{{BASE_PATH}}/assets/wp-images-de/image870.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="159" alt="image" src="{{BASE_PATH}}/assets/wp-images-de/image_thumb55.png" width="361" border="0"></a> </p>
<p>Vielleicht kann das der eine oder andere von euch gut gebrauchen :) Feedback ist wie immer willkommen :)</p>
<p><strong><a href="{{BASE_PATH}}/assets/files/democode/mvclocal/mvclocal.zip">[ Download Democode ]</a></strong></p>
