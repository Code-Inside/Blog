---
layout: post
title: "There is a new GAC with .NET 4.0?"
date: 2013-02-16 17:54
author: antje.kilian
comments: true
categories: [Uncategorized]
tags: []
language: en
---
{% include JB/setup %}
<p>&nbsp; <p>&nbsp; <p><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; border-top: 0px; border-right: 0px; padding-top: 0px" title="image.png" border="0" alt="image.png" src="http://code-inside.de/blog/wp-content/uploads/image1764-446x194.png" width="446" height="194"> <p>.NET 4.0 offers a new Global Assembly Cache (GAC) which you can find at this path:  <p><em>C:\Windows\Microsoft.NET\assembly</em> <p>Every .NET 4.0 or CLR 4.0 application use this GAC.  <p><b>What happens to the „old“ GAC?</b> <p>The old GAC still exists on this path: <p><em>C:\Windows\assembly</em> <p>It is still responsible for .NET 2.0 - .NET 3.5 or CLR 2.0 applications.  <p><b></b> <p><b>CLR? .NET Framework Version? Isn’t that the same thing? </b> <p>The subject is a little more difficult but I like it as a short form: <p>CLR + Libraries = .NET Framework <p>While <a href="http://en.wikipedia.org/wiki/Common_Language_Runtime">CLR</a> is the base of the execution. With several .NET framework versions they added numerous libraries but there are just two big CLR Versions till today – Version 2.0 and 4.0  <p><a href="http://blogs.msdn.com/b/karinm/archive/2008/11/11/what-s-the-difference-between-clr-and-net-framework.aspx">Source</a> <p><b></b> <p><b>Why this change?</b> <p>At this point I want to name my source: <a href="http://stackoverflow.com/questions/2660355/net-4-0-has-a-new-gac-why">Stackoverflow</a>  <p><em>“In .NET Framework 4.0, the GAC went through a few changes. The GAC was split into two, one for each CLR.</em> <p><em>The CLR version used for both .NET Framework 2.0 and .NET Framework 3.5 is CLR 2.0. There was no need in the previous two framework releases to split GAC. The problem of breaking older applications in Net Framework 4.0.</em> <p><em>To avoid issues between CLR 2.0 and CLR 4.0 , the GAC is now split into private GAC’s for each runtime.The main change is that CLR v2.0 applications now cannot see CLR v4.0 assemblies in the GAC.”</em> <p><u>Reason for the change:</u> <p>For example, if both .NET 1.1 and .NET 2.0 shared the same GAC, then a .NET 1.1 application, loading an assembly from this shared GAC, could get .NET 2.0 assemblies, thereby breaking the .NET 1.1 application <p><em>“The CLR version used for both .NET Framework 2.0 and .NET Framework 3.5 is CLR 2.0. As a result of this, there was no need in the previous two framework releases to split the GAC. The problem of breaking older (in this case, .NET 2.0) applications resurfaces in Net Framework 4.0 at which point CLR 4.0 released. Hence, to avoid interference issues between CLR 2.0 and CLR 4.0, the GAC is now split into private GACs for each runtime.”</em> <p><u>Another point:</u> <p><em>“Mark Miller said… June 28, 2010 12:13 PM</em> <p><em>Thanks for the post. “Interference issues” was intentionally vague. At the time of writing, the issues were still being investigated, but it was clear there were several broken scenarios.</em> <p><em>For instance, some applications use Assemby.LoadWithPartialName to load the highest version of an assembly. If the highest version was compiled with v4, then a v2 (3.0 or 3.5) app could not load it, and the app would crash, even if there were a version that would have worked. Originally, we partitioned the GAC under it’s original location, but that caused some problems with windows upgrade scenarios. Both of these involved code that had already shipped, so we moved our (version-partitioned GAC to another place.</em> <p><em>This shouldn’t have any impact to most applications, and doesn’t add any maintenance burden. Both locations should only be accessed or modified using the native GAC APIs, which deal with the partitioning as expected. The places where this does surface are through APIs that expose the paths of the GAC such as GetCachePath, or examining the path of mscorlib loaded into managed code.</em> <p><em>It’s worth noting that we modified GAC locations when we released v2 as well when we introduced architecture as part of the assembly identity. Those added GAC_MSIL, GAC_32, and GAC_64, although all still under %windir%\assembly. Unfortunately, that wasn’t an option for this release.”</em> <p>This message helped me to get a clearer view on the subject. Also I didn’t know that the weird „Assembly-Viewer“ has been removed from Windows 8: <p><b></b>&nbsp; <p><img title="image" border="0" alt="image" src="http://code-inside.de/blog/wp-content/uploads/image_thumb916.png" width="571" height="338"><b></b> <p><b></b>&nbsp; <p><b>Result:</b> <p>Good to know    <p><a href="http://code-inside.de/blog-in/wp-content/uploads/1269602956_dr-mccoy-and-captain-kirk-approve.gif"><img style="display: inline" title="1269602956_dr-mccoy-and-captain-kirk-approve" alt="1269602956_dr-mccoy-and-captain-kirk-approve" src="http://code-inside.de/blog-in/wp-content/uploads/1269602956_dr-mccoy-and-captain-kirk-approve_thumb.gif" width="240" height="181"></a></p>
