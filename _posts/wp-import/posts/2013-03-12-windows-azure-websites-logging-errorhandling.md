---
layout: post
title: "Windows Azure Websites – Logging & ErrorHandling"
date: 2013-03-12 22:30
author: robert.muehsig
comments: true
categories: [Allgemein]
tags: [Azure, Elmah, Websites]
---
{% include JB/setup %}
<p>Die <a href="{{BASE_PATH}}/2013/03/02/windows-azure-websites-git-hosting-deployment-leicht-gemacht/">Azure Websites</a> sind in der Handhabung sehr simpel, dennoch kann man leicht neue Instanzen dazuschalten. Doch was macht man, wenn ein Fehler passiert?</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1783.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb937.png" width="575" height="239"></a> </p> <p><strong>Azure Website Konfiguration</strong></p> <p>Unter den Einstellungen der Azure Websites kann man 3 Diagnose-Tools anschalten:</p> <ul> <li><strong>Detailed Error Logging</strong> – Turn on detailed error logging to capture all errors generated by your web site.  <li><strong>Failed Request Tracing</strong> – Turn on failed request tracing to capture information for failed client requests.  <li><strong>Web Server Logging</strong> – Turn on Web Server logging to save web site logs using the W3C extended log file format.</li> <li></li></ul> <p><a href="http://www.windowsazure.com/en-us/manage/services/web-sites/how-to-monitor-websites/">Quelle: How to monitore web sites</a><br></p> <p>&nbsp;</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1784.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb938.png" width="622" height="415"></a> </p> <p><strong>Wo werden diese Logs gespeichert?</strong></p> <p>Die Logs werden in einem Verzeichnis auf der Maschine abgelegt, welches über <strong>FTP</strong> zugänglich ist. Dafür in das “<strong>Dashboard</strong>” wechseln und dort nach “FTP DIAGNOSTIC LOGS” suchen. Der <strong>Deployment-User</strong> (der auch das Git-Deployment übernimmt) wird dort als Login gebraucht!</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1785.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb939.png" width="398" height="164"></a> </p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1786.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb940.png" width="395" height="333"></a> </p> <p><strong>Ich benötige weitere Logging- / Exception-Informationen</strong></p> <p>Leider sind die Error-Pages nicht wirklich immer zielführend, daher kommt man relativ schnell zu dem Punkt an dem man ein Logging Framework benötigt. </p> <p>ELMAH to the rescue!</p> <p>Ich hatte mich schnell für ELMAH entschieden, samt der zusätzlichen <a href="https://github.com/alexanderbeletsky/elmah.mvc">ASP.NET MVC Integration</a>:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1787.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb941.png" width="458" height="313"></a>&nbsp;</p> <p>Dann noch den XmlFile-Provider einhängen in der web.config:</p> <p><em>&lt;elmah&gt;<br>&nbsp; &lt;errorLog type="Elmah.XmlFileErrorLog, Elmah" logPath="~/App_Data" /&gt;<br>&lt;/elmah&gt;</em> <p>Dann kann man auch via der FTP Seite sich bis zur Seite und dem App_Data Verzeichnis navigieren:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1788.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb942.png" width="457" height="146"></a>&nbsp;</p> <p>Natürlich würde auch Log4Net oder <a href="{{BASE_PATH}}/2013/01/20/logging-mit-nlog/">NLog</a> funktionieren.</p> <p>Damit sollte es auch mit dem Debugging klappen ;)</p> <p><strong>Fazit:</strong></p> <p>Die Azure Websites verhalten sich sehr ähnlich wie eine normale Web-Anwendung auf einem normalen IIS, daher gelten hier fast die selben Bedingungen. Hier ist kein völlig anderes Vorgehen wie bei den Cloud Services (mit den Table Storage und den Diagnostics) von nöten.</p>
