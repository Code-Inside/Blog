---
layout: post
title: "Tools & Vorgehen für Entwicklung rund um OpenXml oder wie erstelle ich Office Dokumente mit .NET?"
date: 2013-04-30 21:17
author: robert.muehsig
comments: true
categories: [Allgemein]
tags: [Office, OpenXML]
---
<p>Durch meine Tätigkeit bei der&nbsp; <a href="http://www.oneoffixx.com/">OneOffixx AG</a> habe ich recht tiefe Einblicke in die Erstellung von Microsoft Office Dokumente mit .NET bekommen. Da das Problem “Office Dokumente per Code” zu erstellen recht verbreitet ist, schreib ich mal Empfehlungen für die ersten Schritte.</p> <h3>Must Have Tools</h3> <p>Ganz klar sollte man das Office in der jeweiligen Version installiert haben – zum Teil unterscheiden sich die Versionen. Für die meisten Fälle sollte es aber klappen, aber lieber nachprüfen bevor der Kunde sich ärgert ;). <br/> <b>Wichtiger Hinweis: OpenXML benötigt keine Office Installation. Man kann es bedenkenlos z.B. auf einem Webserver nutzen. </b></p> <p>Das OpenXML SDK und das OpenXML SDK Productivity Tool for Microsoft Office. Die aktuellste Version ist die 2.5, welches es <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30425"><strong>hier zum Download gibt</strong></a> – wobei man erst das SDK installieren muss und danach die Tools.</p> <p>Visual Studio wäre natürlich von Vorteil ;)</p> <p>Ein guten XML Viewer – Notepad ist leicht nervig. Ich nutze <a href="http://notepad-plus-plus.org/"><strong>Nodepad++</strong></a> mit den XML Tools Plugin.</p> <p><strong>OpenXML ist… kompliziert…</strong></p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1834.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; margin: 0px 10px 0px 0px; border-left: 0px; display: inline" border="0" alt="image" align="left" src="{{BASE_PATH}}/assets/wp-images/image_thumb987.png" width="170" height="330"></a> </p> <p>Microsofts XML Spezifikation liegt “gefühlt” sehr nah an der Ur-Implementierung im binären Format - es finden sich daher oft sehr interessante Konstrukte in XML Form wieder.</p> <p>Das Bild stammt zudem von <a href="http://noooxml.wikidot.com/rice-pudding">dieser Seite</a>, welche den Standard “nicht so gern hat” – ohne Wertung von meiner Seite ;)</p> <p>Da der Umgang in komplexeren Dokumenten <a href="http://msdn.microsoft.com/en-us/library/office/ff478255.aspx">nicht so einfach wie hier dargestellt</a> ist empfehle ich jeden folgendes Vorgehen…</p> <p>&nbsp;</p> <p>&nbsp;</p> <p>&nbsp;</p> <p>&nbsp;</p> <p>&nbsp;</p> <p>&nbsp;</p> <p>&nbsp;</p> <h3>Vorgehen: Wunsch-Dokument erstellen – OpenXML Productivity Tool – Reflect Code FTW!</h3> <p>Am einfachsten ist es sich sein Wunsch-Dokument in Word/Powerpoint/Excel zu erstellen (bzw. ein bestehendes in das Tool laden) und über das Productivity Tool sich den Code dazu anzeigen lassen.</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1835.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb988.png" width="570" height="437"></a> </p> <p>Der erzeugte Code ist zwar “kryptisch”, funktioniert aber (im Sinne von Copy/Paste in ein neues Projekt) und nun kann man sich Stück für Stück den Code refactoren. Das Tool kann neben “Reflect Code” auch ein Diff zwischen zwei Open XML Dateien erzeugen, zum Debugging äusserst hilfreich!</p> <h3>Andere Herangehensweise: Das Zip mal öffnen…</h3> <p>Um die Struktur genauer zu verstehen ist es auch von Vorteil die docx/pptx/xlsx Datei in .zip umzubenennen und die einzelnen XML Files genauer anzuschauen:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1836.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb989.png" width="576" height="304"></a> </p> <h3>Wo liegt denn die DocumentFormat.OpenXml.dll und was brauch ich noch?</h3> <p>Die .NET Assembly wird mit dem SDK installiert:</p> <p><em>C:\Program Files (x86)\Open XML SDK\V2.5\lib</em></p> <p>Das Open XML SDK setzt auf den Namespace System.IO.Packaging auf, <a href="http://msdn.microsoft.com/en-us/library/system.io.packaging.aspx">daher benötigt man noch die WindowsBase.dll</a>.</p> <h3>Das wäre es eigentlich auch schon… </h3> <p>Durchbeissen und Frust-Resistenzen aufbauen ;) </p> <p>Happy Coding!</p>
