---
layout: post
title: "HowTo: Databinding in WPF (& Silverlight 2) - Einstieg"
date: 2008-03-06 23:02
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [.NET 3.0, .NET 3.5, Databinding, Expression Studio, HowTo, Silverlight 2, Visual Studio 2008, WPF, XAML]
---
{% include JB/setup %}
<p>In diesem HowTo geht es um den Einstieg in das Thema &quot;Databinding&quot; mit der <a href="http://de.wikipedia.org/wiki/Windows_Presentation_Foundation">Windows Presentation Foundation</a> (was so eigentlich auch in <a href="http://de.wikipedia.org/wiki/Silverlight">Silverlight 2</a> geht).</p>  <p>Wer Databinding aus ASP.NET her kennt, wird sich in die WPF Databinding M&#246;glichkeiten sicherlich verlieben.</p>  <p><strong>Doch erstmal langsam - was ist eigentlich &quot;Databinding&quot;?</strong></p>  <p>Jeder Entwickler kennt es: Im Code h&#228;uft man sich irgendwelche Daten an und versucht diese dann in das Frontend zu bekommen. Wenn nun der Nutzer die entsprechenden Felder im Frontend ver&#228;ndert, muss man ein h&#228;ndisches Mapping zwischen den UI Daten und den eigentlichen Daten vornehmen, damit die &#196;nderungen auch gespeichert werden. </p>  <p>Das ist meist ein sehr m&#252;hseeliger Prozess, insbesondere da meist auch noch eine Validation gew&#252;nscht ist - darf in dem Feld jetzt ein String stehen? In dem Feld sollte nur eine Postleitzahl stehen etc.</p>  <p>Typische Szenarien - im Web ist dies durch das &quot;zustandslose&quot; HTTP schwierig umzusetzen - in ASP.NET wurde es versucht, allerdings meiner Meinung nach nur mit m&#228;&#223;igem Erfolg. In Windows (oder Silverlight) Applikationen sollte dies doch leichter m&#246;glich sein.</p>  <p>Genau darum dreht sich <a href="http://msdn2.microsoft.com/en-us/library/ms750612.aspx">Databinding</a>. Insbesondere in WPF gibt es einige M&#246;glichkeiten und ich will hier nur mal den ersten Eindruck vermitteln.</p>  <p><strong>Schritt 1: WPF Projekt anlegen</strong></p>  <p>Als erstes legen wir ein WPF Projekt an:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image312.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="283" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb291.png" width="398" border="0" /></a> </p>  <p>Notiz am Rande: Das ganze kann man auch mit <a href="http://www.microsoft.com/expression/products/download.aspx?key=blend2preview">Expression Blend</a> machen, allerdings werde ich mich hier erstmal nur auf Visual Studio 2008 konzentrieren.</p>  <p>Folgende Projektstruktur wird automatisch angelegt:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image313.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="124" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb292.png" width="224" border="0" /></a> </p>  <p>Wir halten uns vornehmlich in der &quot;Window1.xaml&quot; auf.</p>  <p><strong>Schritt 2: Klassen anlegen</strong></p>  <p>Damit wir in unserem Beispiel etwas machen k&#246;nnen, ben&#246;tigen wir 2 kleine Klassen:</p>  <p>&quot;Person&quot;</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image314.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="126" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb293.png" width="305" border="0" /></a> </p>  <p>&quot;Title&quot;</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image315.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="120" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb294.png" width="309" border="0" /></a> </p>  <p><strong>Schritt 3: XAML Binding</strong></p>  <p>Um das ganze Thema etwas zu verstehen, legen wir mal ein Binding direkt in der Window1.xaml an. So sieht das Ergebnis aus:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image316.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="234" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb295.png" width="244" border="0" /></a> </p>  <p>Und so der Code dazu:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image317.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="182" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb296.png" width="524" border="0" /></a> </p>  <p>Das sieht erstmal recht komplex aus - aber gehen wir Schritt f&#252;r Schritt durch.</p>  <p>Wir wollen (in einem <a href="http://msdn2.microsoft.com/en-us/library/system.windows.controls.stackpanel.aspx">StackPanel</a>) ein <a href="http://msdn2.microsoft.com/en-us/library/system.windows.controls.label.aspx">Label</a> bef&#252;llen. Dazu bef&#252;llen wir es mit dem <a href="http://msdn2.microsoft.com/en-us/library/system.windows.data.binding.aspx">Binding Element</a>. &#220;ber &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.windows.data.binding.source.aspx">Source</a>&quot; greifen wir auf eine &quot;<a href="http://msdn2.microsoft.com/en-us/library/ms750613.aspx">StaticResource</a>&quot; auf unser Element namens &quot;MyTitleElement&quot; zu.</p>  <p>Dabei holen wir uns den Wert des Feldes &quot;Value&quot; ab - was ich aber auch BlaBlub nennen h&#228;tte k&#246;nnen. </p>  <p>Direkt im &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.windows.frameworkelement.resources.aspx">Window.Resources</a>&quot; legen wir ein .NET Objekt der Klasse &quot;Title&quot; an (die wir im vorherigen Schritt angelegt haben) und geben ihm &#252;ber <a href="http://msdn2.microsoft.com/en-us/library/ms742804.aspx">x:Key</a> einen Namen und &#252;ber die Property &quot;Value&quot; (wie gesagt, h&#228;tte auch BlaBlub hei&#223;en k&#246;nnen) das was wir rein haben wollen.</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image318.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="63" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb297.png" width="121" border="0" /></a> </p>  <p>Der &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.windows.data.binding.path.aspx">Path</a>&quot; in dem Binding Element gibt am Ende die eigentliche Quelle an.</p>  <p>Damit wir im XAML solche .NET Objekte anlegen k&#246;nnen, m&#252;ssen wir einen xml Namespace hinzuf&#252;gen. &#220;ber &quot;clr-namespace:...&quot; f&#252;gt man .NET Namespaces hinzu.</p>  <p>Um es nochmal hervorzuhebe: Das ganze ohne eine Zeile in der Codebehinde geschrieben zu haben.</p>  <p><strong>Schritt 4: ListBox zur Anzeige von dynamischen Inhalten nehmen.</strong></p>  <p>Um ein etwas komplexeres Beispiel zu zeigen, wollen wir nun mal mehrere &quot;Person&quot; Objekte in einer <a href="http://msdn2.microsoft.com/en-us/library/system.windows.controls.listbox.aspx">ListBox</a> anzeigen.</p>  <p>So wird es hinterher aussehen:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image319.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="244" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb298.png" width="244" border="0" /></a> </p>  <p>Ich hatte jetzt keine gro&#223;e Lust mich erst mit der Formatierung rumzuschlagen ;) Prim&#228;r gehts hier erstmal um Databinding. In einem anderen HowTo machen wir auch &quot;sch&#246;ne&quot; Sachen.</p>  <p>Hier der Code dazu:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image320.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="159" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb299.png" width="383" border="0" /></a> </p>  <p>Wir legen wieder einen Namen an - damit wir im Codebehinde Zugriff darauf haben - und machen unser ItemTemplate - ein &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.windows.datatemplate.aspx">DataTemplate</a>&quot;.</p>  <p>Im Codebehinde reicht dann nur wenige Zeile:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image321.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="293" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb300.png" width="541" border="0" /></a> </p>  <p><strong>Schlussbemerkung</strong></p>  <p>Das ganze Thema Databinding ist nat&#252;rlich noch um einiges Gr&#246;&#223;er - doch vorerst mach ich hier erstmal Schluss. Das n&#228;chste HowTo wird sich dann um das richtige Databinding drehen - mit Dataupdates etc.</p>  <p>Nat&#252;rlich k&#246;nnt ihr auch in der <a href="http://msdn2.microsoft.com/en-us/library/ms750612.aspx">MSDN</a> oder <a href="http://coredotnet.blogspot.com/2006/05/wpf-data-binding-tutorial.html">hier</a> nachschauen. F&#252;r jeden der sich interssiert, w&#252;rde ich auch die Demos von der <a href="http://code-inside.de/blog/2008/03/04/nachtrag-vsone-sildes-demos-zum-download/">VSOne</a> empfehlen.</p>  <p>PS: Ich arbeite mich selber erst in diese Themen ein, daher muss nicht unbedingt alles 100% stimmen. Es hilft mir zum Teil auch, dass ich dies mal aufgeschrieben habe. &quot;Best Practices&quot; sind es also (noch) nicht ;)</p>  <p><strong><a href="http://{{BASE_PATH}}/assets/files/democode/wpfsimpledatabinding/wpfsimpledatabinding.zip">[ Download Democode ]</a></strong></p>
