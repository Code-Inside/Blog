---
layout: post
title: "HowToCode: Build/Deployment/WTF oder auch Automatisierung mit MSBuild"
date: 2010-03-19 00:33
author: robert.muehsig
comments: true
categories: [HowToCode]
tags: [Build, Deployment, MSBuild]
---
{% include JB/setup %}
<p><a href="{{BASE_PATH}}/assets/wp-images/image936.png"><img style="border-right: 0px; border-top: 0px; margin: 0px 10px 0px 0px; border-left: 0px; border-bottom: 0px" height="141" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb121.png" width="186" align="left" border="0"></a>In meinen Azubitagen habe ich mich doch des häufigen gefragt was denn nun ein Build oder ein Deployment ist. Mit der Zeit habe ich mich nun doch mit dem Mysterium beschäftigt und sogar angefangen mit <a href="http://msdn.microsoft.com/de-de/library/wea2sca5.aspx">MSBuild</a> verschiedene Prozesse zu automatisieren. Wie sieht euer Prozess aus?</p><!--more--> <p><strong>Grundbegrifflichkeiten</strong></p> <p>Ich will jetzt keine Wikierklärung von <a href="http://de.wikipedia.org/wiki/Build">Build</a> oder <a href="http://de.wikipedia.org/wiki/Softwareverteilung">Deployment</a> bringen sondern es mal auf das wesentliche runterbrechen bzw. soweit erklären wie ich es auch meinen Azubis weitergebe (wenn ich Quatsch erzähle, dann ist jetzt eure Chance mich zu korrigieren ;) )</p> <ul> <li>Das "bauen" ("Build") von Software passiert z.B. immer wenn ihr im Visual Studio auf den "Run" Button drückt. Im Hintergrund wird der Code kompiliert und im Falle einer ASP.NET Webanwendung wird der Development Server gestartet oder der <a href="http://code-inside.de/blog/2009/03/19/howto-iis7-als-development-server-im-visual-studio-2008-einrichten/">lokale IIS</a>. </li> <li>Beim "Deployment" versteht man das letztendliche veröffentlichen der (gebauten) Software auf einen Webserver bzw. wenn man Clientsoftware hat spricht man auch vom "Rollout". </li></ul> <p>Wenn euer Deployment-Prozess daraus besteht das ihr im Visual Studio auf "Build" drückt und das Ergebnis dann veröffentlicht, dann sollte man sich jedenfalls im professionellen Bereich Gedanken machen ;)</p> <p>Diese Prozesse kann man teilweise auch automatisieren. Jedenfalls bis zu einem gewissen Grad.</p> <p><strong>MSBuild</strong></p> <p>"<a href="http://msdn.microsoft.com/de-de/library/wea2sca5.aspx">MSBuild</a>" ist das Build Framework von Microsoft. Visual Studio nutzt beim Klick auf den "Run" Knopf auch MSBuild. Natürlich kann man MSBuild auch per Kommandozeile aufrufen. Dadurch ist es möglich z.B. das bauen der .NET Anwendungen zu automatisieren. Auf die Möglichkeiten und was wir bisher machen gehe ich später noch kurz ein. </p> <p>Ein genialer Einstieg zum Thema findet sich auf dem Blog von <a href="http://dotnet-forum.de/blogs/thorstenhans/default.aspx">Thorsten Hans</a>:<br><strong><a href="http://dotnet-forum.de/blogs/thorstenhans/archive/2010/02/15/das-msbuild-universum.aspx">Das MSBuild Universum</a></strong></p> <p><strong>"Continuous Integration"</strong></p> <p>In einem anderen Post bin ich bereits auf "<a href="http://code-inside.de/blog/2009/07/08/howtocode-continuous-integration/">Continuous Integration</a>" eingegangen. Dort habe ich bereits angeschnitten was man noch für Möglichkeiten hat - jetzt möchte ich mal konkreter benenne wie wir das gelöst haben:</p> <p>In unserem Projektteam haben nutzen wir die TFS2008 Teambuilds:</p> <ol> <li>Über den Teamexplorer werfe ich ein neues Deployment an.</li> <li>Dieses holt die Sourcen und <strong>baut</strong> die Solution. </li> <li>Die gebaute Website wird nun in unsere <strong>gewünschte</strong> <strong>Ordnerstruktur</strong> (wie sie auf dem Dev/Test/Livesystem ist vorhanden ist) gebracht</li> <li>Die "richtige" <strong>.config wird ausgewählt</strong> und in das config Verzeichnis geschoben.</li></ol> <p>In unserer Entwicklungsumgebung wird nun dieser Ordner auf den Webserver der Entwicklungsumgebung <strong>kopiert und fertig</strong>.<br>Auf den anderen Umgebungen <strong>zippen</strong> wir diesen Ordner und können diesen dann entsprechend kopieren und dann mit <strong>wenigen Handgriffen (kann man das evtl. aber noch mit Powershell oder VBScripts verbessern? -&gt; siehe weiter unten) "live"</strong> schalten.</p> <p>Wir sind auch schon (fast) zufrieden damit. Besonders auf unserer Entwicklungsumgebung hat dies sehr viel Zeit gespart, dass wir per Klick (über MSBuild und ein simplen xcopy Befehl) ein Deployment durchführen können.</p> <p><strong>Unterstützende MSBuild Packs:</strong></p> <p>Da MSBuild von Haus aus nicht sooo viel mitbringt, haben sich die beiden "Tools" sich noch bewährt:</p> <ul> <li><a href="http://msbuildtasks.tigris.org/">MSBuild Community Tasks</a></li> <li><a href="http://www.codeplex.com/MSBuildExtensionPack">MSBuild Extension Pack</a></li></ul> <p><strong>Was vielleicht noch cool wäre...</strong></p> <p>Mit dem TFS2010 wird ja alles besser ( ;) ), aber was ich mir noch nett vorstelle wären diese Sachen:</p> <ul> <li><a href="http://blogs.iis.net/msdeploy/archive/2008/01/22/welcome-to-the-web-deployment-team-blog.aspx"><strong>MSDeploy</strong></a>. <a href="http://therightstuff.de/">Alexander Groß</a> hatte dies auch beim .NET UG Treffen vorgestellt und es wäre sicherlich einen Blick wert. Besonders um IIS Settings "zu ändern" wäre es evtl. hilfreich. Unser Buildserver hat keine direkte Verbindung zu Test bzw. Live (was ja auch ok soweit ist), doch wie kann man z.B. den Home Directory Pfad der Webanwendung auf den neuen Pfad lenken (die alten Versionen bleiben noch auf den Maschinen liegen)? Mit Powershell? Oder einem <a href="http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d3df4bc9-0954-459a-b5e6-7a8bc462960c.mspx?mfr=true">VBScript</a>? Vorhanden ist ein <strong>IIS6</strong></li> <li><strong>UI-Tests</strong>. Gibt es da vielleicht eine einfache Möglichkeit? <a href="http://seleniumhq.org/">Selenium</a> oder gibt es etwas leichtgewichtigeres? Macht das denn überhaupt Sinn solche Tests auszuführen? :)</li> <li>Die <strong>Changesets (und verbundene Tasks/Bugs)</strong> vom TFS seit dem letzten Deployment und die damit verbundenen Tasks - hat da jemand Erfahrung oder einen Blogpost zur Hand?</li></ul> <p><strong>Wie macht ihr das? Welche Tools und Vorgehensweisen haben sich bei euch bewährt?</strong></p>
