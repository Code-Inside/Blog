---
layout: page
title: "HowTo: Automatisierte Backups mit dem Microsoft Office SharePoint 2007"
date: 2007-10-14 19:49
author: robert.muehsig
comments: true
categories: []
tags: []
permalink: /artikel/howto-automatisierte-backups-mit-dem-microsoft-office-sharepoint-2007
---
{% include JB/setup %}
<p>Der <a href="http://office.microsoft.com/de-de/sharepointserver/default.aspx">SharePoint 2007</a>&nbsp;bietet eine Möglichkeit ein Backup direkt über die Weboberfläche anzulegen, allerdings gibt&nbsp;es dabei keine Optionen ob man dies regelmäßig automatisch erstellen möchte. <p>Um jedoch nicht krampfhaft die <a href="http://www.microsoft.com/germany/sql/default.mspx">MS-SQL</a> Datenbank zu sichern um&nbsp;sie hinterher wieder mühevoll einzuspielen, gibt es jedoch ein kleines Tool was direkt mitgeliefert wird: <p>&nbsp;Die <strong>STSADM.exe</strong> ist ein Konsolenadministrationsprogramm, welches sich unter (engl. Windows Server 2003) "C:\Program Files\Common Files\ Microsoft Shared\web server extensions\12\bin" versteckt.<br>Dieses Programm bietet eine Menge Optionen um den SharePoint zu administrieren. Da es ein Konsolenprogramm ist, welches mit verschiedenen Parametern gestartet werden kann, kann man dieses auch leicht in den Windows Shedule verwenden. <p><strong>Parameter für das Erstellen eines Backups:</strong> <p>STSADM.EXE -o backup -directory C:\SharePointBackup -backupmethod full <p>Erklärung:&nbsp;<br>-directory C:\SharePointBackup: ist das&nbsp;Verzeichnis in dem die Backups später gespeichert werden.&nbsp;Der Nutzer muss dabei Schreibrechte auf diesen Ordner haben. Wenn man es über die Weboberfläche macht, muss man (das hat bei mir geholfen) dem Nutzer "Backup" (oder so ähnlich)&nbsp;Schreibrechte für den Ordner geben.<br>- backupmethod full: Hier kann man zwischen&nbsp;einem Vollbackup und einem differenziellen Backup unterscheiden. <p>Es gibt noch mehr Parameter, allerdings speichert dieser Aufruf alles - für mehr Informationen einfach mal die Hilfe anschauen. <p><strong>Parameter für das Wiedereinspielen eines Backups:</strong> <p>STSADM.EXE -o restore -directory C:\SharePointBackup -restoremethod overwrite <p><strong>Erklärung:</strong><br>Durch diesen Befehl kann man das letzte Backup was erstellt wurde (der SharePoint erstellt eine XML Datei, mit allen wesentlichen Informationen, sodass man&nbsp;auch spezielle&nbsp;Backups auswählen kann).<br>- restoremethod overwirte:&nbsp;Überschreibt die bestehenden Daten, es gibt aber auch die Möglichkeit dieses&nbsp;zu verschieben. <p>Es gibt, wie auch bei dem&nbsp;anderen Aufruf, noch viele andere Parameter, jedoch stellt&nbsp;dieser&nbsp;Aufruf, dass letzte Backup wieder komplett her.&nbsp;Falls die&nbsp;Central Administration noch geht, kann&nbsp;das&nbsp;Wiedereinspielen auch bequem über die Weboberfläche erfolgen. <p><strong>Links:</strong> <p><a href="http://office.microsoft.com/de-de/sharepointserver/default.aspx">Microsoft Office SharePoint 2007 Homepage</a><br><a href="http://www.microsoft.com/germany/sql/default.mspx">Microsoft SQL Server Homepage</a><br><a href="http://de.wikipedia.org/wiki/SharePoint">SharePoint Wiki Seite</a></p>
