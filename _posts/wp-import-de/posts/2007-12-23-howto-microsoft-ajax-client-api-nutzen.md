---
layout: post
title: "HowTo: Microsoft AJAX Client API nutzen"
date: 2007-12-23 01:46
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [AJAX, ASP.NET, ASP.NET 3.5, ASP.NET AJAX, HowTo, Javascript, Microsoft]
language: de
---
{% include JB/setup %}
<p>Bereits einmal in einer Wöchentlichen Rundablage erwähnt, möchte ich mich heute mal der AJAX Client API widmen. Die Client API wird oft kaum genutzt, obwohl manche kleinen Helferlein praktisch sind. Infos zu den ASP.NET AJAX Extensions (also der serverseitigen API gibt es z.B. hier in einem HowTo).</p> <p><strong><u>Was ist die ASP.NET AJAX Client API?</u></strong></p> <p>Die AJAX Client API ist entweder für ASP.NET Entwickler direkt in dem Download der ASP.NET AJAX Extensions (oder ASP.NET 3.5) enthalten oder auch als seperater Download zu bekommen. Die Client API kann auch in PHP, JSP, Ruby usw. eingesetzt werden, da es nur eine Javascript Bibliothek ist.</p> <p>Ich werde mit den ASP.NET AJAX Extensions arbeiten, allerdings sind die clientseitigen Sachen später auch bei PHP und co. gültig.</p> <p><strong><u>Wie wird diese eingebunden?</u></strong></p> <p>Sobald man in ASP.NET den Scriptmanager mit einfügt, ist die Client API sofort mit eingebunden und wird mitgeladen:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image191.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="116" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb170.png" width="538" border="0"></a> </p> <p><em>(in PHP und co. muss die Installationsanleitung bei dem seperaten Download angesehen werden)</em></p> <p>Ein Blick in die DOM verrät uns, was alles mit geladen wurde (und das ist nur ein Ausschnitt):</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image192.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="328" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb171.png" width="545" border="0"></a> </p> <p><strong><u>Was hat man nun davon?</u></strong></p> <p> Die Microsoft AJAX API bietet einige kleine Helferlein, welche einem das Javascript-Leben erleichtern können - das dabei aber natürlich immer ein gewisser "Respekt" dabei sein sollte, sollte für alle klar sein: Nur weil eine Bibliothek "verrückte" Sachen erlaubt, heisst das noch lange nicht, dass man diese nutzen muss.</p> <p><strong><u>Die kleinen Helferlein zeige ich mal kurz an 5 Beispielen:</u></strong></p> <p><u>1. Zugriff auf ein DOM Element</u></p> <p>Der Zugriff erfolgt immer über "document.getElementById(...)" oder ähnlichem - die Microsoft AJAX API stellt dafür ein kleine Abkürzung bereit - den "<a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Global/GetShortCutMethod.aspx" target="_blank">$get Shortcut</a>". Das erleichtert immerhin die Tipparbeit ;)</p> <p><u>2. Eventhandler dynamisch anhängen</u></p> <p>Ein Element dynamisch per Javascript mit einem Event versehen ist etwas haarig, da der ID nicht alles mit macht und mir spontan allein 3 Wege einfallen wie man das "klassisch" lösen kann:</p> <ul> <li>über innerHTML die Events "reinschreiben" (das versteht wenigstens auch der IE)</li> <li>über setAttribute (geht beim IE manchmal nicht)</li> <li>über die jeweiligen Eventeigenschaften direkt (wenn man den Syntax nicht direkt im Kopf hat, ist es etwas nervig)</li></ul> <p>Die Microsoft AJAX API erlaubt über den "<a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Global/AddHandlerShortcutMethod.aspx" target="_blank">$addHandler Shortcut</a>" genau das. Leider kann man wohl leider keinen Parameter oder weiteren Kontext mitgeben.</p> <p>Für dieses Thema empfehle ich <a href="http://encosia.com/2007/11/15/exploring-one-of-ms-ajaxs-often-overlooked-features/" target="_blank">diesen Blogbeitrag</a>, da er auch einige andere Features zeigt, z.B. kann man über den "event" Parameter rausbekommen, welcher Knopf gedrückt wurde (<a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Sys.UI/KeyEnum/default.aspx" target="_blank">Enter</a> z.B.) oder wo die Mausposition etc. ist (Wie sowas mit normalen JS geht, wird <a href="{{BASE_PATH}}/2007/11/27/howto-javascript-mouse-over-mousepositionen-fr-details/" target="_blank">hier</a> erklärt.)</p> <p><u>3. Strings verknüpfen</u></p> <p>Einen String mit JS über das "+" zu erzeugen, wird dann schwierig, sobald Zahlen dirn vorkommen. Zahlen werden dann sofort addiert und erst danach an die nachfolgende Zeichenfolge drangeklebt. Das ist nicht immer den Effekt, den man sich wünscht.</p> <p>Microsoft stellt hier eine "<a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Sys/StringBuilderClass/default.aspx" target="_blank">StringBuilder</a>" Klasse zur Verfügung.</p> <p><u>4. Umgang mit Arrays</u></p> <p>In Zeiten von JSON etc. arbeitet man wieder viel auf der Clientseite und möchte angenommen jedes Element eines Arrays an eine spezielle Methode übergeben, damit dieser weiter verarbeitet werden kann. Im normalen JS muss man nun hier erst eine Schleife durchlaufen lassen etc.</p> <p>Microsoft stellt hier eine "<a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Global/JavascriptTypeExtensions/arrayTypeExt/ArrayForEachFunc.aspx" target="_blank">Array.forEach</a>" Methode bereit, die genau dies macht. Die Methode gehört zu den <a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Global/JavascriptTypeExtensions/arrayTypeExt/default.aspx" target="_blank">Array Type Extensions</a>, welcher noch andere Extensions angehören.<br>Dazu ist wahrscheinlich auch <a href="http://encosia.com/2007/12/04/work-smarter-ms-ajaxs-javascript-base-type-extensions/" target="_blank">dieser Blogeintrag</a> sehr interessant und empfehlenswert.</p> <p><u>5. Datumsanzeige</u></p> <p> Wie gerade erwähnt, hat Microsoft einige "Extensions" für normale JS "Typen" bereitgestellt, darunter auch einer für den "<a href="http://asp.net/AJAX/Documentation/Live/ClientReference/Global/JavascriptTypeExtensions/DateTypeExt/default.aspx" target="_blank">Date</a>" Typ. Dieser hilft, Datumsformatierungen wesentlich einfacher vor zu nehmen, als in der <a href="http://de.selfhtml.org/javascript/objekte/date.htm" target="_blank">klassischen Variante</a>. Die "Microsoft" Variante ist aus den bekannten Java oder .NET entnommen und daher eigentlich nichts unbekanntes. Siehe dazu am besten den unteren Abschnitt von <a href="http://encosia.com/2007/12/04/work-smarter-ms-ajaxs-javascript-base-type-extensions/" target="_blank">diesem Blogeintrag</a>.</p> <p><strong><u>Mein Demoprojekt und den Source Code:</u></strong></p> <p>Die 5 Beispiele können live auch <a href="http://code-developer.de/democode/msajaxclientapi/" target="_blank">hier angesehen</a> werden und habe ich im IE7 und Firefox 2 getestet. Da dies alles nur Javascript Code ist, findet ihr auch dort den Source Code.</p> <p><strong><u>Fazit:</u></strong></p> <p>Die Client API ist sehr interessant wenn man sich einmal eingearbeitet hat und stellt einige Erleichterungen bereit. Einen Blick ist sie auf alle Fälle wert und wenn man ohnehin die ASP.NET AJAX Server Funktionalitäten nutzt, kann man die vom Client doch auch mal mit einbauen.</p> <p>Die komplette Client Reference findet ihr <a href="http://asp.net/AJAX/Documentation/Live/ClientReference/default.aspx" target="_blank">hier</a>.</p> <p><strong><a href="http://code-developer.de/democode/msajaxclientapi/" target="_blank">[ Demoanwendung + Sourcecode ]</a></strong></p>
