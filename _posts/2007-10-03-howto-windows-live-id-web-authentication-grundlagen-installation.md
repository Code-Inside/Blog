---
layout: page
title: "HowTo: Windows Live ID Web Authentication (Grundlagen & Installation)"
date: 2007-10-03 12:49
author: robert.muehsig
comments: true
categories: []
tags: []
---
<p>Jeder der schonmal irgendein Microsoft Dienst genutzt hat, hat entweder mit dem ("gescheiterten") <a href="http://de.wikipedia.org/wiki/Microsoft_Passport-Netzwerk" target="_blank">Passport</a> oder der <a title="Registrierung" href="https://accountservices.passport.net/reg.srf?sl=1&amp;lc=1031" target="_blank">Windows Live ID</a> schon zu tun gehabt.<br>Mir persönlich gefällt es nicht, dass ich mich bei jedem Dienst immer eine neues Passwort merken muss - warum bindet man denn zum Beispiel nicht den Windows Live ID Dienst mit in seine eigene Website ein?</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image32.png" atomicselection="true"><a href="{{BASE_PATH}}/assets/wp-images/image38.png" atomicselection="true"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="57" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb31.png" width="250" border="0"></a></a>&nbsp;</p> <p><strong>Erstmal ein Wort der Warnung:</strong></p> <p>SingleSignOn Dienste wie zum Beispiel Windows Live ID sind immer wieder in der Kritik unsicher &amp; datenschutztechnisch bedenklich&nbsp;zu sein. Angenommen viele Websiten würden sich nur auf den Windows Live ID Dienst als Anmeldeverfahren speziallisieren, dann gäbe es das Problem, dass Microsoft die Profile der Nutzer quasi immer weiter ausbauen könnte. Datenschutztechnisch nicht gerade so toll.<br>Auf der anderen Seite muss man nur ein Sicherheitsloch bei Microsofts Windows Live ID finden und man würde viele Websiten aushebeln - Sicherheitstechnisch auch nicht gerade super.</p> <p>Ich persönliche würde es so angehen wenn ich eine ernsthafte Anwendung entwickeln würde: Die Windows Live ID zu nutzen finde ich praktisch, allerdings würde ich dem Nutzer die Wahl stellen ob er sich mit Windows Live ID anmeldet oder über einen eigenes Anmeldesystem. OpenID wäre auch mal ein Blick wert.<br>Windows Live ID vorauszusetzen wäre etwas frech, aber als Feature einen Blick wert - daher der Blogeintrag.</p> <p>Fangen wir jetzt mal an was man alles dazu braucht, um die Windows Live ID zu nutzen:</p> <p>&nbsp;</p> <p><strong>SDK von Windows Live ID herunterladen</strong></p> <p>Auf der <a title="Windows Live ID Web Authentication" href="http://msdn2.microsoft.com/de-de/library/bb676633.aspx" target="_blank">MSDN Seite</a>&nbsp;findet man allgemeine Informationen zum Web Autentication SDK. Das direkte SDK kann man direkt bei <a title="Windows Live ID SDK Microsoft Download" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=8BA187E5-3630-437D-AFDF-59AB699A483D&amp;displaylang=en" target="_blank">Microsoft Download</a> runterladen. Dabei gibt es das SDK nicht nur für Microsofts hauseigenes ASP.NET, sondern auch für:</p> <p>- Java<br>- PHP<br>- Phyton<br>- Ruby<br>- Perl</p> <p>(wie gut oder schlecht diese Beispiele sind, möchte ich hier jetzt nicht sagen)</p> <p><u>Achtung:</u> Die MSI läuft auf nicht-englischen Windows Versionen nicht durch und bricht ab, Grund: Der Installer sucht nach zwei Benutzergruppen, welche in der englischen vorhanden sind, aber in der deutschen nicht: Power Users &amp; Users. D.h. damit der Installer durchläuft einfach die beiden Gruppen anlegen.</p> <p>&nbsp;</p> <p><strong>Windows Live ID Applikation anmelden</strong></p> <p>Um den Windows Live ID Dienst zu nutzen, muss man sich auf <a href="https://msm.live.com/app/default.aspx" target="_blank">dieser Website</a> registrieren. <a href="http://msdn2.microsoft.com/de-de/library/bb676626.aspx" target="_blank">Hier</a> ist der Vorgang kurz beschrieben.</p> <p>&nbsp;</p> <p><strong>Überblick über die Datein des SDKS (ASP.NET Implementation)</strong></p> <p>(Ich hab die Ordnerstruktur leicht geändert - Original liegen die ASPX Seiten in einem "Sample" Ordner, den hab ich einfachheitshalber entfernt und die Datein direkt ins Root Verzeichnis verschoben)</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image33.png" atomicselection="true"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="150" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb32.png" width="233" border="0"></a> </p> <p>Wichtigste Datei ist die "<strong>WindowsLiveLogin.cs</strong>" welche die Kernarbeit übernimmt.<br>Im Überblick habe ich mir diese Datei mal angesehen, allerdings kann man diese so als gegeben betrachten.</p> <p><strong>Datei:</strong> Default.aspx</p> <p>Die Default.aspx ist für die Anzeige des "Sign In" / "Sign Out" verantwortlich und bindet dazu ein ÃFrame ein:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image34.png" atomicselection="true"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="218" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb33.png" width="437" border="0"></a> </p> <p>In der "src" wird als Parameter noch eine Schriftart/größe etc. mitgegeben, damit man den Sign In / Sign Out entsprechend noch formatieren kann - es gibt bestimmt auch Bilder die man einblenden kann. Außerdem hängt man dort noch seine AppID dran - das sieht man aber gut in der SDK Datei.</p> <p>Im Codebehinde wird geprüft ob das Logincookie schon abgelegt wurde, wenn nicht ist man nicht angemeldet.</p> <p>Die "Zugangsdaten" stehen dabei in der Web.Config:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image35.png" atomicselection="true"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="110" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb34.png" width="455" border="0"></a>&nbsp; <br><em>(aus dem SDK)</em></p> <p><strong>Datei:</strong> webauth-handler.aspx</p> <p>Diese legt das Cookie an oder löscht es und dient als ReturnURL für den Windows Live ID Dienst. Im Anschluss leitet die Seite an die Default.aspx weiter.</p> <p>In dem Schaubild hab ich mal den Datenfluss zusammengestellt:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image36.png" atomicselection="true"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="313" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb35.png" width="271" border="0"></a>&nbsp;<br><em>(Ich brauch unbedingt Visio daheim)</em></p> <p>&nbsp;</p> <p><strong>Anwendung des ganzen</strong></p> <p>Ich hab die SDK Datein mal online gestellt, damit jeder sehen kann, was der Seitenbetreiber nach dem Anmelden eigentlich sieht:<br>Eine eindeutige User ID zum Weiterverarbeiten.<br><br>Hier die <a href="http://www.code-developer.de/democode/windowsliveid/default.aspx" target="_blank">Demoseite</a> zum&nbsp;Anschauen.&nbsp;</p> <p><strong>Wichtige Links im Überblick:</strong></p> <p>- <a title="Windows Live ID Anmeldung" href="https://accountservices.passport.net/reg.srf?sl=1&amp;lc=1031" target="_blank">Windows Live ID Anmeldung</a><br>- <a title="Windows Live ID Blog" href="http://winliveid.spaces.live.com/" target="_blank">Windows Live ID Blog</a><br>- <a title="Windows Live ID MSDN" href="http://msdn2.microsoft.com/de-de/library/bb676633.aspx" target="_blank">Windows Live ID MSDN Seite</a><br>- <a href="https://msm.live.com/app/default.aspx" target="_blank">Windows Live Application ID</a><br>- <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=8BA187E5-3630-437D-AFDF-59AB699A483D&amp;displaylang=en" target="_blank">Windows Live ID Web Authentication SDK Download</a><br>- <a href="http://www.code-developer.de/democode/windowsliveid/default.aspx" target="_blank">Windows Live ID Web Authentication Sample Demopage</a></p>
